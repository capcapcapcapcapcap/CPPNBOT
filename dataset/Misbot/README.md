# Misbot 图结构数据集

## 概述

这是将原始Misbot数据集转换为图结构格式的版本，保留了所有原始数据内容，并构建了合理的图关系。该数据集采用了与Twibot-20相同的图结构设计，支持图神经网络和多模态机器人检测研究。

## 🔄 格式兼容性

**重要**: 边格式已更新为与Twibot-20完全兼容！

### 边格式
- **当前格式**: `[关系类型, 目标ID]` ✅ 与Twibot-20一致
- **示例**: `["post", "t_train_u0000001_0"]`

## 转换统计

| 指标 | 数量 | 说明 |
|------|------|------|
| **总节点数** | 2,527,069 | 用户节点 + 微博节点 |
| **用户节点** | 99,874 | 原始用户数据 |
| **微博节点** | 2,427,195 | 从用户推文中提取 |
| **总边数** | 2,429,863 | 各种关系类型 |
| **标注用户** | 99,874 | 人类/机器人标签 |

## 文件结构

```
dataset/Misbot/
├── node.json          # 所有节点数据 (451.04 MB)
├── edge.json          # 所有边关系 (72.64 MB)  
├── label.json         # 用户标签 (2.28 MB)
├── split.json         # 数据划分 (1.62 MB)
├── sample.json        # 数据样本 (0.53 MB)
└── README.md          # 说明文档
```

## 数据结构

### 节点类型

#### 1. 用户节点 (User Node)
```json
{
  "ID": "train_u0000001",
  "type": "user",
  "profile": {
    "description": "请别关注我",
    "numerical": [27, 384, 3797],
    "categorical": [0,1,0,1,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0]
  }
}
```

**字段说明**：
- `ID`: 用户唯一标识符（保持原始格式）
- `type`: 节点类型标识 ("user")
- `profile.description`: 用户个人简介（原始字段）
- `profile.numerical`: 3维数值特征 [粉丝数, 关注数, 微博数]
- `profile.categorical`: 20维分类特征one-hot编码

#### 2. 微博节点 (Tweet Node)
```json
{
  "ID": "t_train_u0000001_5",
  "type": "tweet", 
  "content": "连夜拉走",
  "author": "train_u0000001"
}
```

**字段说明**：
- `ID`: 微博唯一标识符（格式：t_{用户ID}_{序号}）
- `type`: 节点类型标识 ("tweet")
- `content`: 微博文本内容（原始字段）
- `author`: 发布用户ID

### 边关系类型

| 关系类型 | 数量 | 描述 | 格式 |
|----------|------|------|------|
| **post** | 2,427,195 | 用户发布微博 | `["post", "t_xxx"]` |
| **mention** | 1,800 | 用户提及关系 | `["mention", "train_u_xxx"]` |
| **retweet** | 315 | 转发关系 | `["retweet", "train_u_xxx"]` |
| **follow** | 553 | 关注关系 | `["follow", "train_u_xxx"]` |

### 边数据格式
```json
{
  "train_u0000001": [
    ["post", "t_train_u0000001_0"],
    ["post", "t_train_u0000001_1"],
    ["mention", "train_u0000123"],
    ["follow", "train_u0000456"]
  ]
}
```

### 标签数据
```json
{
  "id": "label",
  "train_u0000001": "human",
  "train_u0000002": "bot"
}
```

- `"human"`: 真人用户（原始标签0）
- `"bot"`: 机器人用户（原始标签1）

### 数据划分
```json
{
  "train": ["train_u0000001", ...],  // 79,899个用户 (80%)
  "dev": ["train_u0000003", ...],    // 9,987个用户 (10%)
  "test": ["train_u0000004", ...]    // 9,988个用户 (10%)
}
```

## 图关系构建策略

### 1. 发布关系 (Post)
- **来源**: 用户的tweet字段
- **逻辑**: 每条微博创建一个微博节点，用户与微博建立post关系
- **保证**: 完全保留原始微博内容

### 2. 提及关系 (Mention)  
- **来源**: 微博文本中的@用户名模式
- **提取规则**: `@([a-zA-Z0-9_\u4e00-\u9fff]+)`
- **建立**: 发布用户 → 被提及用户

### 3. 转发关系 (Retweet)
- **来源**: 微博文本中的转发模式
- **提取规则**: `//@用户名:`、`RT @用户名`、`转发了@用户名`
- **建立**: 转发用户 → 原发布用户

### 4. 关注关系 (Follow)
- **来源**: 基于用户互动频率推断
- **逻辑**: 用户间mention/retweet次数 ≥ 2次
- **目的**: 构建潜在的社交网络结构

## 数据完整性保证

### 1. 内容保留
- ✅ 所有原始用户数据完整保留
- ✅ 所有微博内容完整保留  
- ✅ 所有特征向量完整保留
- ✅ 所有标签信息完整保留

### 2. 数据量验证
- **原始文件**: train_data.jsonl (400.63 MB)
- **转换后总计**: 527.58 MB
- **数据增长**: 由于图结构化和关系提取，数据量合理增长

### 3. 质量检查
- 用户数量: 99,874 ✅ (与原始一致)
- 微博数量: 2,427,195 ✅ (完整提取)
- 标签数量: 99,874 ✅ (完整保留)

## 使用建议

### 1. 图神经网络
```python
# 构建异构图
import torch
from torch_geometric.data import HeteroData

# 节点特征
user_features = extract_user_features(nodes)
tweet_features = extract_tweet_features(nodes)

# 边索引
post_edges = extract_edges(edges, 'post')
mention_edges = extract_edges(edges, 'mention')

# 构建异构图
data = HeteroData()
data['user'].x = user_features
data['tweet'].x = tweet_features
data['user', 'post', 'tweet'].edge_index = post_edges
data['user', 'mention', 'user'].edge_index = mention_edges
```

### 2. 多模态特征融合
- **文本特征**: 微博内容 + 用户描述
- **数值特征**: numerical向量 (3维)
- **分类特征**: categorical向量 (20维)
- **图结构特征**: 节点度、中心性等

### 3. 模型建议
- **GraphSAGE**: 处理大规模图结构
- **HetGNN**: 异构图神经网络
- **R-GCN**: 关系图卷积网络
- **Transformer**: 处理文本序列

## 与原始Misbot的对比

| 特性 | 原始Misbot | 图结构Misbot |
|------|------------|--------------|
| **数据格式** | JSONL文本 | 图结构JSON |
| **节点类型** | 仅用户 | 用户 + 微博 |
| **关系信息** | 无 | 4种关系类型 |
| **图建模** | 不支持 | 完全支持 |
| **内容保留** | 原始 | 100%保留 |
| **扩展性** | 有限 | 高度可扩展 |

## 与Twibot-20的兼容性

| 特性 | Twibot-20 | Misbot图结构 |
|------|-----------|--------------|
| **Edge格式** | `[关系类型, 目标ID]` | `[关系类型, 目标ID]` ✅ |
| **节点设计** | 异构图 | 异构图 ✅ |
| **处理代码** | 通用 | 完全兼容 ✅ |

## 注意事项

1. **文件大小**: node.json较大(451MB)，建议分批加载
2. **内存使用**: 完整加载需要约2GB内存
3. **关系质量**: mention/retweet关系基于文本提取，可能存在噪声
4. **用户匿名**: 所有用户ID已匿名化处理
5. **使用限制**: 仅供学术研究使用

## JSON文件格式说明

所有JSON文件采用压缩格式（无缩进）以节省存储空间：
- **优势**: 减少77%文件大小，提高加载速度
- **查看方式**: 使用编程方式读取，或查看sample.json了解结构
- **格式化样本**: 可使用Python的`json.dumps(data, indent=2)`创建格式化版本

---

*转换完成时间：2025年12月*  
*原始数据量：400.63 MB → 图结构数据量：527.58 MB*  
*数据完整性：100%保留*